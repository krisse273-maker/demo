<script>
  // Navigera till login-sidan
  const goLoginBtn = document.getElementById("goLoginBtn");
  goLoginBtn.addEventListener("click", () => {
    window.location.href = "login.html";
  });

  // Hantera registrering av användare
  const registerBtn = document.getElementById("registerBtn");
  registerBtn.addEventListener("click", () => {
    const name = document.getElementById("name").value;
    const email = document.getElementById("email").value;
    const password = document.getElementById("password").value;

    if (!name || !email || !password) {
      alert("Please fill in all fields!");
      return;
    }

    // Logga information för felsökning
    console.log("Attempting to create user with email:", email);

    // Skapa användare med Firebase Auth
    auth
      .createUserWithEmailAndPassword(email, password)
      .then((userCredential) => {
        const user = userCredential.user;

        // Logga användarens info för felsökning
        console.log("User created in Firebase Auth:", user);

        // Spara användaren i Firestore (för att lägga till namn)
        db.collection("users").doc(user.uid).set({
          name: name,
          email: user.email,
          createdAt: firebase.firestore.FieldValue.serverTimestamp(),
        })
        .then(() => {
          // Logga när användaren är sparad i Firestore
          console.log("User saved in Firestore:", name);

          // Spara användaren i localStorage (för myfood.html)
          localStorage.setItem(
            "currentUser",
            JSON.stringify({ email: user.email, name: name })
          );

          // Skicka användaren direkt till myfood.html
          window.location.href = "myfood.html";
        })
        .catch((error) => {
          // Hantera Firestore-sparandet
          console.error("Error saving user in Firestore:", error);
          alert("Error saving user in Firestore: " + error.message);
        });
      })
      .catch((error) => {
        // Hantera registreringsfelet
        console.error("Registration failed:", error);
        alert("Registration failed: " + error.message);
      });
  });
</script>
